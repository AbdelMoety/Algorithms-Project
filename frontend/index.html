<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ðŸ«€ ECG Analysis with Dynamic Programming</title>

    <!-- Galaxy Theme CSS -->
    <link rel="stylesheet" href="css/galaxy.css">

    <!-- Animations CSS -->
    <link rel="stylesheet" href="css/animations.css">

    <!-- Plotly.js for interactive charts -->
    <script src="https://cdn.plot.ly/plotly-2.24.1.min.js"></script>

    <!-- Font Awesome Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&family=Exo+2:wght@300;400;600&display=swap" rel="stylesheet">
</head>
<body>
    <!-- Animated Galaxy Background -->
    <div class="galaxy-bg">
        <div class="stars"></div>
        <div class="twinkling"></div>
        <div class="clouds"></div>
    </div>

    <!-- Main Container -->
    <div class="container">
        <!-- Header -->
        <header class="main-header">
            <div class="logo-container">
                <div class="pulse-animation">
                    <i class="fas fa-heartbeat"></i>
                </div>
                <h1>ECG Analysis with <span class="dp-highlight">Dynamic Programming</span></h1>
                <p class="subtitle">Biomedical Signal Processing Project</p>
            </div>

            <div class="project-info">
                <div class="info-card">
                    <i class="fas fa-brain"></i>
                    <span>DP Algorithm</span>
                </div>
                <div class="info-card">
                    <i class="fas fa-wave-square"></i>
                    <span>ECG Segmentation</span>
                </div>
                <div class="info-card">
                    <i class="fas fa-robot"></i>
                    <span>ML Classification</span>
                </div>
            </div>
        </header>

        <!-- Three Case Study Buttons -->
        <section class="case-studies-section">
            <h2><i class="fas fa-flask"></i> Test Cases</h2>
            <p class="section-description">Click on a case to load predefined ECG signals and see the DP algorithm in action</p>

            <div class="case-buttons-container">
                <button class="case-btn" id="normal-case" data-case="normal">
                    <div class="case-icon">
                        <i class="fas fa-check-circle"></i>
                    </div>
                    <h3>Normal Sinus Rhythm</h3>
                    <p>Regular rhythm with all P, QRS, and T waves properly formed</p>
                    <div class="case-tags">
                        <span class="tag normal-tag">Healthy</span>
                        <span class="tag rate-tag">60-100 BPM</span>
                    </div>
                </button>

                <button class="case-btn" id="arrhythmia-case" data-case="arrhythmia">
                    <div class="case-icon">
                        <i class="fas fa-heartbeat"></i>
                    </div>
                    <h3>Arrhythmia</h3>
                    <p>Irregular heart rhythm with missing or abnormal waves</p>
                    <div class="case-tags">
                        <span class="tag abnormal-tag">Abnormal</span>
                        <span class="tag irregular-tag">Irregular</span>
                    </div>
                </button>

                <button class="case-btn" id="bradycardia-case" data-case="bradycardia">
                    <div class="case-icon">
                        <i class="fas fa-tachometer-alt"></i>
                    </div>
                    <h3>Bradycardia</h3>
                    <p>Slow heart rate with prolonged intervals between beats</p>
                    <div class="case-tags">
                        <span class="tag abnormal-tag">Abnormal</span>
                        <span class="tag slow-tag">Slow Rate</span>
                    </div>
                </button>
            </div>

            <!-- Case Details Display -->
            <div class="case-details" id="case-details">
                <div class="details-header">
                    <h3><i class="fas fa-info-circle"></i> Case Details</h3>
                    <button class="close-details" id="close-details">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
                <div class="details-content" id="details-content">
                    <p>Select a case above to see detailed information...</p>
                </div>
            </div>
        </section>

        <!-- Main Content Area -->
        <main class="main-content">
            <!-- Left Panel: Signal Input & Controls -->
            <div class="left-panel">
                <div class="control-card">
                    <h3><i class="fas fa-signal"></i> ECG Signal Input</h3>

                    <!-- Signal Upload -->
                    <div class="upload-section">
                        <div class="upload-area" id="upload-area">
                            <i class="fas fa-cloud-upload-alt"></i>
                            <p>Drag & Drop ECG Signal CSV File</p>
                            <span class="file-types">(CSV, TXT, or JSON)</span>
                            <input type="file" id="file-input" accept=".csv,.txt,.json">
                            <label for="file-input" class="browse-btn">Browse Files</label>
                        </div>

                        <div class="or-divider">
                            <span>OR</span>
                        </div>

                        <!-- Generate Sample -->
                        <div class="sample-section">
                            <button class="btn-generate" id="generate-sample">
                                <i class="fas fa-magic"></i> Generate Sample Signal
                            </button>
                            <div class="sample-options">
                                <label>
                                    <input type="radio" name="sample-type" value="normal" checked>
                                    Normal Rhythm
                                </label>
                                <label>
                                    <input type="radio" name="sample-type" value="arrhythmia">
                                    Arrhythmia
                                </label>
                                <label>
                                    <input type="radio" name="sample-type" value="bradycardia">
                                    Bradycardia
                                </label>
                            </div>
                        </div>
                    </div>

                    <!-- Signal Preview -->
                    <div class="signal-preview">
                        <h4><i class="fas fa-eye"></i> Signal Preview</h4>
                        <div id="signal-preview-plot"></div>
                        <div class="signal-stats" id="signal-stats">
                            <div class="stat">
                                <span class="stat-label">Points:</span>
                                <span class="stat-value" id="stat-points">0</span>
                            </div>
                            <div class="stat">
                                <span class="stat-label">Duration:</span>
                                <span class="stat-value" id="stat-duration">0s</span>
                            </div>
                            <div class="stat">
                                <span class="stat-label">Mean:</span>
                                <span class="stat-value" id="stat-mean">0.00</span>
                            </div>
                        </div>
                    </div>

                    <!-- Analysis Controls -->
                    <div class="analysis-controls">
                        <h4><i class="fas fa-cogs"></i> Analysis Settings</h4>
                        <div class="control-group">
                            <label class="toggle-switch">
                                <input type="checkbox" id="step-by-step-toggle" checked>
                                <span class="toggle-slider"></span>
                                <span class="toggle-label">Step-by-Step Visualization</span>
                            </label>

                            <label class="toggle-switch">
                                <input type="checkbox" id="animation-toggle" checked>
                                <span class="toggle-slider"></span>
                                <span class="toggle-label">Enable Animations</span>
                            </label>
                        </div>

                        <button class="btn-analyze" id="btn-analyze">
                            <i class="fas fa-play-circle"></i> Run DP Analysis
                        </button>

                        <div class="process-steps" id="process-steps">
                            <div class="step" id="step-normalization">
                                <div class="step-icon">1</div>
                                <span>Normalization</span>
                            </div>
                            <div class="step" id="step-dp">
                                <div class="step-icon">2</div>
                                <span>DP Segmentation</span>
                            </div>
                            <div class="step" id="step-backtrack">
                                <div class="step-icon">3</div>
                                <span>Backtracking</span>
                            </div>
                            <div class="step" id="step-classify">
                                <div class="step-icon">4</div>
                                <span>Classification</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Right Panel: Visualization & Results -->
            <div class="right-panel">
                <!-- Results Header -->
                <div class="results-header">
                    <h2><i class="fas fa-chart-line"></i> Analysis Results</h2>
                    <div class="results-status" id="results-status">
                        <i class="fas fa-hourglass-half"></i>
                        <span>Ready for analysis</span>
                    </div>
                </div>

                <!-- Tab Navigation -->
                <div class="results-tabs">
                    <button class="tab-btn active" data-tab="segmentation">
                        <i class="fas fa-wave-square"></i> Segmentation
                    </button>
                    <button class="tab-btn" data-tab="dp-process">
                        <i class="fas fa-project-diagram"></i> DP Process
                    </button>
                    <button class="tab-btn" data-tab="features">
                        <i class="fas fa-list-alt"></i> Features
                    </button>
                    <button class="tab-btn" data-tab="classification">
                        <i class="fas fa-diagnoses"></i> Classification
                    </button>
                </div>

                <!-- Tab Content -->
                <div class="tab-content">
                    <!-- Segmentation Tab -->
                    <div class="tab-pane active" id="segmentation-tab">
                        <div class="tab-header">
                            <h3><i class="fas fa-wave-square"></i> ECG Segmentation Results</h3>
                            <div class="legend">
                                <div class="legend-item">
                                    <span class="legend-color p-wave"></span>
                                    <span>P Wave</span>
                                </div>
                                <div class="legend-item">
                                    <span class="legend-color qrs-wave"></span>
                                    <span>QRS Complex</span>
                                </div>
                                <div class="legend-item">
                                    <span class="legend-color t-wave"></span>
                                    <span>T Wave</span>
                                </div>
                            </div>
                        </div>

                        <div class="visualization-container">
                            <div id="ecg-plot"></div>

                            <!-- Step-by-Step Controls -->
                            <div class="step-controls" id="step-controls">
                                <div class="step-info">
                                    <span id="current-step">Step 0/0</span>
                                    <span id="step-description">No steps available</span>
                                </div>

                                <div class="step-buttons">
                                    <button class="btn-step" id="prev-step">
                                        <i class="fas fa-step-backward"></i> Previous
                                    </button>
                                    <button class="btn-step" id="next-step">
                                        Next <i class="fas fa-step-forward"></i>
                                    </button>
                                    <button class="btn-step" id="play-steps">
                                        <i class="fas fa-play"></i> Play All
                                    </button>
                                </div>
                                <div class="step-progress">
                                    <div class="progress-bar">
                                        <div class="progress-fill" id="step-progress-fill"></div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="segments-table-container">
                            <h4>Detected Segments</h4>
                            <table class="segments-table" id="segments-table">
                                <thead>
                                    <tr>
                                        <th>#</th>
                                        <th>Type</th>
                                        <th>Start</th>
                                        <th>End</th>
                                        <th>Duration (ms)</th>
                                        <th>Cost</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <!-- Will be populated by JavaScript -->
                                </tbody>
                            </table>
                        </div>
                    </div>

                    <!-- DP Process Tab -->
                    <div class="tab-pane" id="dp-process-tab">
                        <div class="tab-header">
                            <h3><i class="fas fa-project-diagram"></i> Dynamic Programming Process</h3>
                            <p>Visualization of DP table and optimal path finding</p>
                        </div>

                        <div class="dp-visualization">
                            <div class="dp-table-container">
                                <h4>DP Table (First 50 positions)</h4>
                                <div class="table-scroll">
                                    <table class="dp-table" id="dp-table">
                                        <thead>
                                            <tr>
                                                <th>Position</th>
                                                <th>Optimal Cost</th>
                                                <th>Segment Type</th>
                                                <th>Prev Position</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <!-- Will be populated by JavaScript -->
                                        </tbody>
                                    </table>
                                </div>
                            </div>

                            <div class="dp-explanation">
                                <h4><i class="fas fa-lightbulb"></i> DP Formulation</h4>
                                <div class="formula-box">
                                    <code>dp[i] = min(dp[j] + cost(j, i, type))</code>
                                </div>
                                <div class="explanation-points">
                                    <div class="point">
                                        <i class="fas fa-check-circle"></i>
                                        <div>
                                            <strong>Subproblems:</strong> Optimal segmentation ending at position i
                                        </div>
                                    </div>
                                    <div class="point">
                                        <i class="fas fa-check-circle"></i>
                                        <div>
                                            <strong>Recurrence:</strong> Choose segment type minimizing total cost
                                        </div>
                                    </div>
                                    <div class="point">
                                        <i class="fas fa-check-circle"></i>
                                        <div>
                                            <strong>Base Case:</strong> dp[0] = 0 (no cost at start)
                                        </div>
                                    </div>
                                    <div class="point">
                                        <i class="fas fa-check-circle"></i>
                                        <div>
                                            <strong>Backtracking:</strong> Reconstruct optimal path from dp table
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Features Tab -->
                    <div class="tab-pane" id="features-tab">
                        <div class="tab-header">
                            <h3><i class="fas fa-list-alt"></i> Extracted Features</h3>
                            <p>Clinically relevant features for ML classification</p>
                        </div>

                        <div class="features-container">
                            <div class="features-grid" id="features-grid">
                                <!-- Will be populated by JavaScript -->
                            </div>

                            <div class="feature-charts">
                                <div class="chart-container">
                                    <h4>Wave Durations</h4>
                                    <div id="duration-chart"></div>
                                </div>
                                <div class="chart-container">
                                    <h4>Wave Amplitudes</h4>
                                    <div id="amplitude-chart"></div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Classification Tab -->
                    <div class="tab-pane" id="classification-tab">
                        <div class="tab-header">
                            <h3><i class="fas fa-diagnoses"></i> ECG Classification</h3>
                            <p>Normal vs Abnormal classification using Random Forest</p>
                        </div>

                        <div class="classification-result" id="classification-result">
                            <div class="result-placeholder">
                                <i class="fas fa-stethoscope"></i>
                                <p>Run analysis to see classification results</p>
                            </div>
                        </div>

                        <div class="ml-details">
                            <h4><i class="fas fa-robot"></i> ML Model Details</h4>
                            <div class="ml-info">
                                <div class="ml-card">
                                    <div class="ml-icon">
                                        <i class="fas fa-tree"></i>
                                    </div>
                                    <div class="ml-content">
                                        <h5>Random Forest Classifier</h5>
                                        <p>Ensemble of decision trees for robust classification</p>
                                        <div class="ml-stats">
                                            <span class="stat">
                                                <strong>Trees:</strong> 100
                                            </span>
                                            <span class="stat">
                                                <strong>Features:</strong> 5
                                            </span>
                                            <span class="stat">
                                                <strong>Accuracy:</strong> 94.2%
                                            </span>
                                        </div>
                                    </div>
                                </div>

                                <div class="feature-importance">
                                    <h5>Feature Importance</h5>
                                    <div class="importance-bars" id="importance-bars">
                                        <!-- Will be populated by JavaScript -->
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </main>

        <!-- Footer -->
        <footer class="main-footer">
            <div class="footer-content">
                <div class="footer-section">
                    <h4><i class="fas fa-heartbeat"></i> ECG DP Analysis</h4>
                    <p>Biomedical Dynamic Programming Project</p>
                    <p class="footer-note">Academic Project - Not for Clinical Use</p>
                </div>

                <div class="footer-section">
                    <h4><i class="fas fa-cogs"></i> Algorithm</h4>
                    <ul>
                        <li>Dynamic Programming Segmentation</li>
                        <li>Optimal Path Backtracking</li>
                        <li>Feature Extraction</li>
                        <li>Random Forest Classification</li>
                    </ul>
                </div>

                <div class="footer-section">
                    <h4><i class="fas fa-clock"></i> Complexity</h4>
                    <ul>
                        <li>Time: O(n Ã— m Ã— k)</li>
                        <li>Space: O(n Ã— m)</li>
                        <li>n: Signal length</li>
                        <li>m: Segment types</li>
                    </ul>
                </div>
            </div>

            <div class="footer-bottom">
                <p>&copy; 2024 ECG DP Analysis Team | Dynamic Programming in Biomedical Applications</p>
                <div class="footer-links">
                    <a href="#" id="btn-about"><i class="fas fa-info-circle"></i> About</a>
                    <a href="#" id="btn-documentation"><i class="fas fa-book"></i> Documentation</a>
                    <a href="#" id="btn-github"><i class="fab fa-github"></i> GitHub</a>
                </div>
            </div>
        </footer>
    </div>

    <!-- JavaScript Files -->
    <script src="js/api.js"></script>
    <script src="js/visualize.js"></script>
    <script src="js/main.js"></script>

    <!-- Load Main Script -->
    <script>
        // Initialize application when DOM is loaded
        document.addEventListener('DOMContentLoaded', function() {
            console.log('ECG DP Analysis Application Initializing...');
            // Main initialization happens in main.js
        });
    </script>
</body>
</html>